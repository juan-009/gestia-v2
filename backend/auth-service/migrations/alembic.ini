[alembic]
# Configuración básica de Alembic
script_location = migrations
sqlalchemy.url = postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}
prepend_sys_path = .
file_template = %%(year)d%%(month).2d%%(day).2d_%%(hour).2d%%(minute).2d%%(second).2d_%%(slug)s
timezone = UTC

# Configuración de logging
[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console

[formatters]
keys = generic

[logger_root]
level = WARN
handlers = console
qualname =

[logger_sqlalchemy]
level = WARN
handlers =
qualname = sqlalchemy.engine

[logger_alembic]
level = INFO
handlers =
qualname = alembic

[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[formatter_generic]
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S

# Configuración avanzada
[post_write_hooks]
# hooks = black

[version_locations]
migrations/versions

[template_args]
# Variables disponibles en plantillas de migración
project_name = auth_service
enable_async = true

# Extensiones personalizadas
[alembic:exclude]
# Tablas que deben ser ignoradas en las migraciones automáticas
tables = spatial_ref_sys, alembic_version

[alembic:include]
# Opciones especiales para tablas específicas
tabla.users = {"include_columns": ["id", "email"]}

# Configuración de entorno dinámico
[env]
# Variables de entorno requeridas
REQUIRED_ENV_VARS = POSTGRES_USER, POSTGRES_PASSWORD, POSTGRES_HOST, POSTGRES_DB

# Opciones de migración
[run]
# Ejecutar migraciones en transacción implícita
transactional_ddl = true

# Configuración de revisiones automáticas
[autogenerate]
# Opciones para la generación automática de migraciones
context_configure = compare_server_defaults=True
render_as_batch = true
include_symbol = lambda name, schema: not name.startswith('_')